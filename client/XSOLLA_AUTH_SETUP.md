# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Xsolla Auth

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ Xsolla

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://publisher.xsolla.com/
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Login Project

1. –í Publisher Account –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Players > Login**
2. –ù–∞–∂–º–∏—Ç–µ **Create Project** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Login Project ID** –∏–∑ Dashboard

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ OAuth 2.0 Client ID

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Players > Login > Security > OAuth 2.0**
2. –ù–∞–∂–º–∏—Ç–µ **Add client** –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Client ID**

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redirect URLs

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö OAuth 2.0 Client –¥–æ–±–∞–≤—å—Ç–µ:

**Callback URLs:**
- `http://localhost:3000` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- `https://yourdomain.com` (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

**Allowed Origins (CORS):**
- `http://localhost:3000`
- `https://yourdomain.com`

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env.local`:
   ```bash
   cp .env.example .env.local
   ```

2. –û—Ç–∫—Ä–æ–π—Ç–µ `.env.local` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
   ```env
   NEXT_PUBLIC_XSOLLA_PROJECT_ID=–≤–∞—à_project_id
   NEXT_PUBLIC_XSOLLA_CLIENT_ID=–≤–∞—à_client_id
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä:
   ```bash
   pnpm dev
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
2. –ù–∞ –≤–∫–ª–∞–¥–∫–µ **Xsolla Auth** –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
   - ‚úì "Xsolla SDK –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"
   - –ê–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "üîê –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Xsolla"
3. –ü—Ä–∏ –∫–ª–∏–∫–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ Xsolla
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è

## –ë–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Xsolla

–ï—Å–ª–∏ Xsolla –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –≤—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- **Xsolla ID** - –≤—Ö–æ–¥ –ø–æ ID (—Å–∏–º—É–ª—è—Ü–∏—è)
- **–ì–æ—Å—Ç—å** - –ø—Ä–æ—Å—Ç–æ–π –≤—Ö–æ–¥ –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –¢–∏–ø—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### 1. Xsolla Auth (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π)
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Xsolla Login
- –¢—Ä–µ–±—É–µ—Ç PROJECT_ID –∏ CLIENT_ID
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π OAuth 2.0 flow
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: username, email, token

### 2. Xsolla ID (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π)
- –í—Ö–æ–¥ –ø–æ Xsolla User ID
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç PROJECT_ID
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- TODO: –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É ID —á–µ—Ä–µ–∑ API

### 3. Guest (–≥–æ—Å—Ç–µ–≤–æ–π)
- –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ —Å –∏–º–µ–Ω–µ–º
- –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ UserData

```typescript
interface UserData {
  username: string;      // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  email: string;         // Email
  authType: AuthType;    // 'xsolla' | 'xsolla-id' | 'guest'
  xsollaToken?: string;  // –¢–æ–∫–µ–Ω (—Ç–æ–ª—å–∫–æ –¥–ª—è xsolla)
}
```

## Troubleshooting

### Xsolla SDK –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ CORS
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä

### –û—à–∏–±–∫–∞ "Invalid redirect URI"

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ redirect

**–†–µ—à–µ–Ω–∏–µ:**
1. –í Xsolla Publisher Account –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Callback URLs
2. –î–æ–±–∞–≤—å—Ç–µ `http://localhost:3000` –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Å/–±–µ–∑ trailing slash)

### –û–∫–Ω–æ –≤—Ö–æ–¥–∞ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PROJECT_ID –∏ CLIENT_ID —É–∫–∞–∑–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ popup –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Xsolla Publisher Account](https://publisher.xsolla.com/)
- [Xsolla Login Documentation](https://developers.xsolla.com/doc/login/)
- [Xsolla API Reference](https://developers.xsolla.com/api/login/)

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤—Ö–æ–¥ (Guest)
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Xsolla
